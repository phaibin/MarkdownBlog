---
layout: post
title: 架设KMS服务器激活Windows 2008 R2(或Windows 7)（转）
date: 2011-01-17 05:14
categories:
- 生活
tags: []
published: true
comments: true
---
<p><p>原帖：<a title="http://www.ecjtu.org/forum/thread-27799-1-1.html" href="http://www.ecjtu.org/forum/thread-27799-1-1.html">http://www.ecjtu.org/forum/thread-27799-1-1.html</a>，略有修改</p>  <p>很多朋友安装了Windows NT6系列内核的操作系统（Win7和Win 2008），操作系统的激活成了问题，KMS激活的出现使这些问题得以解决（尤其是Windows 2008系列服务器操作系统）</p>  <p><strong>首先介绍什么是KMS激活技术：</strong></p>  <p>简单的说，KMS是激活认证服务器，是微软一种新的保护正版的技术，该技术的原理是大家的操作系统需要定期（3个月）跟KMS服务器进行激活验证，保证运行的系统是经过正版许可的。那么很容易想到，如果我能自己架设一个KMS服务器，是不是就可以自己激活自己的系统了呢，答案当然是肯定的。</p>  <p>当然，KMS并不是激活Windows系统的唯一办法，Win7可以通过模拟刷BIOS的办法去获取OEM的正版认证，但是为了应对微软的各种反盗版措施，KMS是最稳定的选择（对于Windows 2008系列几乎是唯一选择），因为经过自行架设KMS认证的系统和官方KMS认证的系统没有任何差别，你不必担心任何微软潜在的反盗版措施对你造成影响。</p>  <p>现在正式开始介绍如何使用KMS技术架设激活认证服务器并激活：</p>  <p><strong>思路：</strong></p>  <p>在虚拟机中架设KMS服务器并配置</p>  <p>在本机修改时区并更改KMS配置</p>  <p>通过KMS服务器激活</p>  <p><strong>1.架设KMS服务器</strong></p>  <p>简单介绍下虚拟机：</p>  <p>虚拟机就是运行在本机上的另一台虚拟主机，虽然和本机共享各种硬件资源，但是在逻辑上和本机完全独立，可以通过导入虚拟机文件的方式使别人的虚拟机在自己的电脑上运行。</p>  <p>得益于俄罗斯的破解高手的辛苦努力，微软KMS服务器已经被破解并制作成虚拟机在网上发布，首先大家需要下载这个虚拟机文件。</p>  <p>下载地址:</p>  <p><a href="http://u.115.com/file/f5b0ec3544">http://u.115.com/file/f5b0ec3544#</a></p>  <p>下载完成后，首先解压缩到一个文件夹中，然后安装VM 7虚拟机并打开这个虚拟机文件</p>  <p><a href="http://phaibin.files.wordpress.com/2011/01/011122aiugruggqui2wwiu1.jpg"><img title="011122aiugruggqui2wwiu" border="0" alt="011122aiugruggqui2wwiu" src="http://phaibin.files.wordpress.com/2011/01/011122aiugruggqui2wwiu-thumb2.jpg" width="554" height="400" /></a> </p>  <p>在启动虚拟机之前建议按照下面的方法配置虚拟机</p>  <p>在面板上找到虚拟机配置选项进入配置菜单</p>  <p><a href="http://phaibin.files.wordpress.com/2011/01/011122hzqsmzyj0hrhnsh93.jpg"><img title="011122hzqsmzyj0hrhnsh9" border="0" alt="011122hzqsmzyj0hrhnsh9" src="http://phaibin.files.wordpress.com/2011/01/011122hzqsmzyj0hrhnsh9-thumb2.jpg" width="554" height="258" /></a> </p>  <p>配置虚拟网络连接为桥接模式</p>  <p><a href="http://phaibin.files.wordpress.com/2011/01/0111227idederaa73a2h3n2.jpg"><img title="0111227idederaa73a2h3n" border="0" alt="0111227idederaa73a2h3n" src="http://phaibin.files.wordpress.com/2011/01/0111227idederaa73a2h3n-thumb2.jpg" width="507" height="244" /></a>&#160; </p>  <p><strong>2.启动虚拟机并配置</strong></p>  <p>单击系统托盘的时间，打开时间设定窗口，点击Time Zone选项卡，将时区选定为莫斯科(+3)，</p>  <p><a href="http://phaibin.files.wordpress.com/2011/01/011122ccpuulluaxa8uuux2.jpg"><img title="011122ccpuulluaxa8uuux" border="0" alt="011122ccpuulluaxa8uuux" src="http://phaibin.files.wordpress.com/2011/01/011122ccpuulluaxa8uuux-thumb2.jpg" width="438" height="379" /></a> </p>  <p>接下来启动桌面上的KMS Manger 2，提示选择日期。这是非常的一步，你需要配置KMS服务器的时间。为什么要配置KMS服务器的时间呢，因为系统需要每隔一段时间就对版权验证信息进行校验，所以服务器的时间非常重要。我们可以在看到对话框中看到给出了2009至2020年的选项（在后面的选项中你还要选择月份，时间格式为：日_月_年时_分），你应该如何选择呢？最简单的方法就是查看桌面壁纸，找到比你当前日期早的最近的一个日期。比如我现在是2011年1月17日，我需要选择23.09.2010，因为每隔6个月会激活一次。</p>  <p><a href="http://phaibin.files.wordpress.com/2011/01/image2.png"><img title="image" border="0" alt="image" src="http://phaibin.files.wordpress.com/2011/01/image-thumb3.png" width="324" height="489" /></a></p>  <p>设定完毕后，确定，系统自动重启，按照预期情况重启后将会自动弹出一个命令行窗口（黑底绿字），</p>  <p><a href="http://phaibin.files.wordpress.com/2011/01/0111236oy78ao70oytcc873.jpg"><img title="0111236oy78ao70oytcc87" border="0" alt="0111236oy78ao70oytcc87" src="http://phaibin.files.wordpress.com/2011/01/0111236oy78ao70oytcc87-thumb2.jpg" width="554" height="422" /></a> </p>  <p>需要确认的是，绿色文字中&quot;Current Count选项&quot;应该为25，（每激活一台减1），若为0或1则表示操作没有成功，需要重新配置！</p>  <p>现在配置结束，我们还需要知道虚拟机的IP。值得注意的是，如果VM分配给你的IP地址和你本机的IP地址不在同一段的话，可能在后面的激活过程会遇到问题，这种情况请修改VM对虚拟IP的设置！</p>  <p>好了，虚拟机搞定了，可千万别傻乎乎的把虚拟机给关了：）……我们转到本机上来~</p>  <p>首先，点击系统托盘的时间进入时间设定窗口，点击&quot;更改日期和时间设置&quot;，点击&quot;更改时区&quot;，将时区设定为莫斯科(+3)，</p>  <p><a href="http://phaibin.files.wordpress.com/2011/01/011123idinkngbktk2tzig2.jpg"><img title="011123idinkngbktk2tzig" border="0" alt="011123idinkngbktk2tzig" src="http://phaibin.files.wordpress.com/2011/01/011123idinkngbktk2tzig-thumb3.jpg" width="434" height="281" /></a> </p>  <p>再点击&quot;更改日期和时间&quot;，根据虚拟机的当前时间（可能和实际时间严重不符，但是以虚拟机的时间为准）设定一个相近的时间，这个时间最好在虚拟机时间之后的相近处，如虚拟机时间为：2010年9月23日18:35，那么你最好把本机时间设为2010年9月23日19:35。</p>  <p><strong>3.在本机执行激活</strong></p>  <p>在命令行界面中输入</p>  <p><strong>slmgr.vbs -ipk [CD-Key]</strong></p>  <p>在下面列表中找打自己系统对应的CD-Key</p>  <p>Windows 7 Professional    <br />FJ82H-XT6CR-J8D7P-XQJJ2-GPDD4 </p>  <p>Windows 7 Professional N    <br />MRPKT-YTG23-K7D7T-X2JMM-QY7MG </p>  <p>Windows 7 Enterprise    <br />33PXH-7Y6KF-2VJC9-XBBR8-HVTHH </p>  <p>Windows 7 Enterprise N    <br />YDRBP-3D83W-TY26F-D46B2-XCKRJ </p>  <p>Windows 7 Enterprise E    <br />C29WB-22CC8-VJ326-GHFJW-H9DH4</p>  <p>Windows Server 2008 R2 HPC Edition    <br />FKJQ8-TMCVP-FRMR7-4WR42-3JCD7 </p>  <p>Windows Server 2008 R2 Datacenter    <br />74YFP-3QFB3-KQT8W-PMXWJ-7M648 </p>  <p>Windows Server 2008 R2 Enterprise    <br />489J6-VHDMP-X63PK-3K798-CPX3Y </p>  <p>Windows Server 2008 R2 for Itanium    <br />GT63C-RJFQ3-4GMB6-BRFB9-CB83V </p>  <p>Windows Server 2008 R2 Standard    <br />YC6KT-GKW9T-YTKYR-T4X34-R7VHC </p>  <p>Windows Web Server 2008 R2    <br />6TPJF-RBVHG-WBW2R-86QPH-6RTM4 </p>  <p>如你的系统是Windows Server 2008 R2 Enterprise ，你输入的命令应该是：</p>  <p>slmgr.vbs -ipk 489J6-VHDMP-X63PK-3K798-CPX3Y </p>  <p>接着，输入</p>  <p><strong>slmgr.vbs -skms [虚拟机IP]:1688</strong></p>  <p>如你的虚拟机IP是172.16.85.146，输入的命令应该是 slmgr.vbs -skms 172.16.85.146:1688</p>  <p>最后，输入</p>  <p><strong>slmgr.vbs -ato</strong></p>  <p>见证奇迹的时刻，如果看到激活成功的提示，说明激活成功，你可以把服务器的时间和时区改回来，重启计算机~</p>  <p>简单总结下几种失败的情况以及悲剧的原因，基本上都是时区设置的<br />
缘故，虽然理论上不必完全一致，但建议还是和虚拟机时间和时区保持一致，这样可以保证100%的成功率，激活完成后再改成正常时间即可。虽然整个过程有些麻烦而且每隔半年就要激活一次，但是对于有特殊要求和需要使用服务器操作系统的玩家来说，这个实在不算什么~</p></p>
