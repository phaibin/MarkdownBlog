---
layout: post
title: 用pkgtools更新软件
date: 2005-12-20 10:56
categories:
- FreeBSD
tags: []
published: true
comments: true
---
<p><p>1.先从sysinstall或make install安装portupgrade，ports位置在/usr/ports/sysutils/portupgrade。<br />2.用CVSUP更新ports树。<br />3.在每次运行portupgrade之前运行pkgdb -F。<br />4.几个有用的参数：-a 全部安裝的 packages<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -PP 堅持只用 package，不用 ports<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-r 把 depends on given ports 的 packages 也一起更新，比如說 -r png-* 的話，會把需要 png 的 packages 一起更新<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; -R 把 given ports 需要的 packages 也一起更新，比如說 -R kde3 的話，會把其他 kde3-* 的一起更新</p><p>例如：<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 更新portupgrade&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; portupgrade -rRPP portupgrade（不用指定版本号）<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 更新所有软件&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;portupgrade -arRPP <br />5.portinstall相当于portupgrade -N。<br />6.可以先用下载工具下载所要更新的软件最新版本，放到/usr/ports/packages/，这样portupgrade的时候会先从这里找，找不到才从网上找，下载后也是放在这里。<br />7.修改/usr/local/etc/pkgtools.conf，改变下载的路径和工具。找到这么两行：<br /><font face="Courier New">&nbsp; # ENV['PKG_FETCH'] = &quot;wget -O '%2$s' '%1$s'&quot;<br />&nbsp; # ENV['PKG_FETCH'] = &quot;curl '%s' -o '%s'&quot;</font><br />如果要用这两个工具就去掉相应的注释。axel的语法为：<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font face="Courier New">ENV['PKG_FETCH'] = &quot;axel -o '%2$s' '%1$s'&quot;<br />下面的这行<br />#&nbsp;&nbsp; ENV['PACKAGEROOT'] = 'ftp://ftpN.XX.FreeBSD.org'<br />用来改变ftp站点，可以改为&quot;</font><font face="Courier New">ftp://ftp.jp.FreeBSD.org</font><font face="Courier New">&quot;<br />在最后找到：<br />&nbsp; PKG_SITES = [<br />&nbsp;&nbsp;&nbsp; pkg_site_mirror(),<br />&nbsp; ]<br />改为：<br />&nbsp; PKG_SITES = [<br />&nbsp;&nbsp;&nbsp; &quot;http://pointyhat.freebsd.org/errorlogs/i386-6-packages-latest/&quot;,<br />&nbsp; ]<br /><a href="http://pointyhat.freebsd.org/errorlogs/">http://pointyhat.freebsd.org/errorlogs/</a>为FreeBSD官方的package列表。<br />8.可以用 portversion 取代 pkg_version 來檢查可以 upgrade 的 packages。portversion 用法跟他一樣，而且比較快。<br />9.有时候portversion显示的资料不准，就用portsdb －uU修复INDEX，时间在一个半小时左右。</font></p></p>
